\documentclass[11pt]{ltjsarticle}

\usepackage{fontspec}
\usepackage{luatexja-fontspec}
\usepackage[hiragino-pron]{luatexja-preset}
\usepackage{luatexja-ruby}
\usepackage{graphicx}
\usepackage{amsmath, amssymb}
\usepackage{csvsimple}

\title{実習B 通信システム設計演習}
\author{三軒家 佑將 \\ 1026-26-5817}
\date{}

\newcommand{\fg}[4][\textwidth]{ % \fg{label}{path}{caption},
	\begin{figure}
		\centering
		\fbox{
			\includegraphics[width=#1]{./communication_system_2016_12_02/#3}
		}
		\caption{#4}
		\label{#2}
	\end{figure}
}

\newcommand{\tab}[3]{ % \tab{label}{csv-path}{caption}
	\begin{table}[htb]
  		\begin{center}
			\csvautotabular{./communication_system_2016_12_02/#2}
    		\caption{#3}
			\label{#1}
  		\end{center}
	\end{table}
}

\newcommand{\fr}[1]{図\ref{#1}}
\newcommand{\tr}[1]{表\ref{#1}}

\begin{document}
\maketitle

\section{目的}
	アナログ無線受信機の３方式、すなわち、ストレート受信機、スーパーヘテロダイン2乗検波受信機、同期検波受信機について、National Instruments 社のシュミレーションソフト LabVIEW を用いて受信回路を作成し、特性を解析する。
\section{方法}
	\subsection{LabVIEWの使い方}
		教科書の例に習い、OOK信号を出力する回路を作成した。
	\subsection{用いる素子の特性解析}
		\subsubsection{LPF}
			与えられたファイル（whistler.vi）とホイッスラー音声ファイル（whistler.wav）を用いて、LPFの動作を確認した。
			
			また、与えられたファイル（chirp.vi）を用いて、LPFによる劣化量$\epsilon$が最小になるようなカットオフ周波数を数値的に求めた。
			ここで、劣化量$\epsilon$は、
			$$
				\epsilon = \sqrt{\frac{\sum^{N}_{i=1} \left( S_{org} - S_{rec} \right)^2}{N\overline{S_{org}^{2}}}}
			$$
			によって定めた。

		\subsubsection{Amp}
			AmpブロックにSin波を入力し、出力波形を観察した。
			また、Distブロックにより歪み率を測定して、増幅度による波形劣化の様子を調べた。
	\subsection{アナログ信号受信時の特性解析}
		\subsubsection{アナログ送信波の構成}
			異なる搬送波周波数の３つのAM変調波と、適当な最大雑音振幅をもつガウス雑音を足し合わせ、アナログ送信波を構成した。３つのAM変調波のパラメーターは以下の通りとした。
			\begin{description}
				\item[所望波] \mbox{}
					\begin{description}
						\item[搬送波周波数] 1400kHz
						\item[変調周波数] 1000Hz
						\item[変調度] 40\%
					\end{description}
				\item[妨害波1] \mbox{}
					\begin{description}
						\item[搬送波周波数] 1350kHz
						\item[変調周波数] 1100Hz
						\item[変調度] 40\%
					\end{description}
				\item[妨害波2] \mbox{}
					\begin{description}
						\item[搬送波周波数] 1450kHz
						\item[変調周波数] 900Hz
						\item[変調度] 40\%
					\end{description}
			\end{description}
			
			また、この送信波回路とBPF、Ampを用いて、高周波増幅を行ない、BPFのQ値によって、妨害波の抑圧度$\alpha$がどう変化するかを調べた。ここで、妨害度$\alpha$は、
			\begin{eqnarray}
				\alpha = P_{D} - {\rm max}\left( P_{I1},P_{I2} \right) \label{eq1}
			\end{eqnarray}
			によって定めた。ただし、$P_{D}$は所望波の出力(dB)を、$P_{I1},P_{I2}$はそれぞれ妨害波1,2の出力(dB)を表している。

		\subsubsection{受信機の作成}
			教科書を参考に、ストレート受信機、スーパーヘテロダイン2乗検波受信機、同期検波受信機の回路を作成した。
		\subsubsection{受信機の特性}
			ストレート受信機とスーパーヘテロダイン２乗検波受信機にて、信号の受信を行い、さらにDistブロックを用いて各受信機のひずみ率を計算した。
			
			ただし、受信時のパラメーターは以下のようである。
			\begin{description}
				\item[ストレート受信機] \mbox{}
					\begin{description}
						\item[LPFのカットオフ周波数] 1000Hz
						\item[BPFのQ] 100
						\item[BPFの中心周波数] 1400kHz
					\end{description}
				\item[スーパーヘテロダイン2乗検波受信機] \mbox{}
					\begin{description}
						\item[１段目のBPFのQ] 100
						\item[１段目のBPFの中心周波数] 1400kHz
						\item[２段目のBPFのQ] 100
						\item[２段目のBPFの中心周波数（中間周波数）] 450kHz
						\item[LPFのカットオフ周波数] 1500Hz
					\end{description}
			\end{description}
			また、ストレート受信機の特性測定時のみ、誤って送信波に含まれるホワイトノイズの最大振幅を1とした（スーパーヘテロダイン２乗検波受信機の場合は最大振幅0とした）。

	\subsection{デジタル信号受信時の特性解析}
		\subsubsection{デジタル送信波の構成}
		\subsubsection{ストレート受信機の特性}
		\subsubsection{スーパーヘテロダイン2乗検波受信機の特性}
		\subsubsection{同期検波受信機の特性}

\section{結果} % プログラムの画像、出力されたグラフ、実験結果の表
	\subsection{LabVIEWの使い方}
		\fg{fg1}{1.how_to_use/how__to__used.png}{OOK信号出力回路}
		\fr{fg1}のように回路を作成した。
	\subsection{用いる素子の特性解析}
		\subsubsection{LPF}
			\fg{fg2}{2.whistler/whistlerp.png}{LPFの動作}
			\fg{fg3}{3.lpf_hizumi/chirpp.png}{LPFによる劣化}
			
			LPFを用いてホイッスラー音声ファイルを加工したときの、音声波形と周波数スペクトルをグラフにしたのが\fr{fg2}である。
			また、LPFを用いて雑音の入った疑似ホイッスラー音声ファイルを加工したときの、音声波形と周波数スペクトルをグラフにしたのが\fr{fg3}である。
			
			これらの図において、左の２つの図が音声波形であり、右の２つの図が周波数スペクトルである。また、上の２つの図がLPFの加工の前の音声についてのグラフであり、下の２つの図がLPFによる加工の後の音声についてのグラフである。

			
			\fr{fg2}の周波数スペクトルを表す２つの図から、LPFによりカットオフ周波数（6000Hz）より大きい周波数成分がカットされている事がわかる。

			劣化量$\epsilon$が最小になるカットオフ周波数$f_c$を探索したところ、\fr{fg3}のとおり、$f_c=9000(Hz)$周辺にて劣化量が最小（$\epsilon=5.75$）となった。

		\subsubsection{Amp}
			実験のミスにより、データが保存されていなかった。

	\subsection{アナログ信号受信時の特性解析}
		\subsubsection{アナログ送信波の構成}
			\fg{fg4}{5.noise/Q_10/noised.png}{アナログ送信機と高周波増幅回路}
			\tab{tb1}{5.noise/alpha.csv}{Q値ごとの妨害度}
			
			\fr{fg4}が、作成した回路である。
			この回路図の前段がアナログ送信機の回路であり、後段が高周波増幅回路である。
			
			また、\tr{tb1}は、BPFのQ値と、その時の妨害波の抑圧度である。これを見ると、Q値が大きくなると抑圧度が大きくなる事がわかる。
		\subsubsection{受信機の作成}
			\fg{fg5}{6.1.straight/noised.png}{ストレート受信機}
			\fg{fg6}{6.2.superhetero/noised.png}{スーパーヘテロダイン2乗検波受信機}
			\fg{fg7}{7.sync/isou_0/noised.png}{同期検波受信機}
			
			\fr{fg5}、\fr{fg6}、\fr{fg7}がそれぞれ、ストレート受信機、スーパーヘテロダイン2乗検波受信機、同期検波受信機の回路図である。

		\subsubsection{受信機の特性}
			\fg[0.5\textwidth]{fg8}{6.1.straight/noisep.png}{ストレート受信機の受信波形}
			\fg[0.5\textwidth]{fg9}{6.2.superhetero/noisep.png}{スーパーヘテロダイン2乗検波受信機の受信波形}

			\fr{fg8}、\fr{fg9}がそれぞれ、ストレート受信機、スーパーヘテロダイン２乗検波受信機によって復号された信号の波形である。また、歪み率はそれぞれ、0.087\%と0.356\%となった。
	\subsection{デジタル信号受信時の特性解析}
		\subsubsection{デジタル送信波の構成}
		\subsubsection{ストレート受信機の特性}
		\subsubsection{スーパーヘテロダイン2乗検波受信機の特性}
		\subsubsection{同期検波受信機の特性}

\section{考察}
		\subsection{課題5}
			式（\ref{eq1}）の、抑圧度としての妥当性を検討する。
			
			まず、抑圧度$\alpha$を、所望波の出力$A_D$と、妨害波の出力$A_I$を用いて、
			$$
				\alpha = 10{\rm log }\left( \frac{A_D}{A_I} \right)
			$$
			で定義する。
			ところで、パワースペクトルの値（所望波$P_D$、妨害波$P_I$）は、LabVIEWが表示するグラフ上ではデシベル単位で表示されているため、
			\begin{eqnarray*}
				P_D - P_I & = & 10{\rm log} \left( \frac{A_D}{A_0} \right) - 10{\rm log} \left( \frac{A_I}{{A_0}} \right) \\
						  & = & 10{\rm log} \left( \frac{A_D}{A_I} \right)
			\end{eqnarray*}
			である。ただし、$A_0$は、デシベルの基準値である。これより、
			$$
				\alpha = P_D - P_I
			$$
			となる。ところで、実験の設定では、妨害波が２つある。実際にはどちらもほとんど同じ値を示したため、式（\ref{eq1}）では適当に、２つの妨害波のうちより大きい値を示したものを$P_I$として採用するようにした。
		
\end{document}
